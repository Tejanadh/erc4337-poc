# Executive Summary: Externally-Triggerable Stipend-Ceiling Drain via postOp OOG in EntryPoint v0.8.0

A deterministic, repeatable gas-accounting weakness in EntryPoint.sol v0.8.0 enables external actors to force paymasters to be charged near the full postOp gas stipend when postOp runs Out‑of‑Gas (OOG) inside the stipend-limited call. Because the failure is swallowed and gas usage is accounted unconditionally, an attacker can repeatedly push charges toward the stipend ceiling—independent of the paymaster’s intended business logic—creating a predictable and scalable deposit drain.

Demonstrated with a minimal PoC and multiple controls, the effect scales linearly with both the configured stipend and gas price: for example, at 1 gwei the measured deposit deltas are ~0.000103504 ETH per operation for a 100,000-gas stipend and ~0.000201004 ETH for 200,000 gas (≈2×). Non‑OOG reverts do not produce stipend‑scale deltas, isolating OOG as the specific trigger. Under realistic activity (50–100 ops/hour) and typical gas conditions (5–30 gwei), daily losses per paymaster reach the five‑figure range, with higher exposure during congestion.

This is not a dispute over the “execution pays” principle; it is a griefing vector arising from stipend‑ceiling weaponization. Normal L1 semantics charge for actual gas consumed on revert; here, OOG in a stipend‑limited postOp call allows near‑ceiling charges—regardless of whether postOp completed its intended work. Many real‑world postOp patterns (loops over dynamic storage, ERC‑20 interactions with hooks/fee‑on‑transfer, chained external calls, SSTORE‑heavy bookkeeping) can be adversarially nudged into OOG by external inputs, making exploitation practical without privileges.

Mitigation can preserve design intent while eliminating exploitability: continue charging for execution failures, but bound postOp failure charges so they cannot systematically approach the stipend ceiling (e.g., charge measured gas with an upper bound well below the stipend, or apply a small bounded penalty specifically on OOG). Patch‑validation tests show the drain disappears under such a bound while successful postOp paths continue to charge appropriately.

Until a code change is adopted, operator guidance is warranted: minimize postOp stipends to the lowest safe value, avoid OOG‑prone postOp patterns, and monitor for stipend‑scale deltas correlated with postOp failures. The PoC, proportionality tests, gas‑price scaling results, control cases, and a pseudo‑diff mitigation are prepared and can be shared via a secure channel.
